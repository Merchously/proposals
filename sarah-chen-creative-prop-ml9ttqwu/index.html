<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Proposal</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto+Slab:wght@500;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --pageBg:#fff;
      --text:#0b1320;
      --muted: rgba(11,19,32,.68);
      --border: rgba(11,19,32,.10);
      --accent:#3cb54c;
      --accentSoft:#e9f7ee;
      --maxw: 1100px;
      --radius: 18px;
      --shadow: 0 18px 60px rgba(0,0,0,.08);
      --hFont: "Roboto Slab", ui-serif, Georgia, serif;
      --bFont: "Montserrat", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{ margin:0; font-family: var(--bFont); color: var(--text); background: var(--pageBg); }
    a{ color: inherit; text-decoration: none; }
    .wrap{ max-width: var(--maxw); margin: 0 auto; padding: 0 18px; }
    .topbar{ position: sticky; top: 0; z-index: 50; background: rgba(255,255,255,.78); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); }
    .topbar-inner{ display:flex; align-items:center; justify-content:space-between; gap: 14px; padding: 12px 0; }
    .brand{ display:flex; align-items:center; gap: 10px; min-width: 0; }
    .logo{ width: 34px; height: 34px; border-radius: 10px; border: 1px solid var(--border); background: #fff; overflow:hidden; display:flex; align-items:center; justify-content:center; flex: 0 0 34px; }
    .logo img{ width:100%; height:100%; object-fit:contain; padding: 6px; display:block; }
    .brand-meta{ min-width:0; }
    .brand-name{ font-weight: 800; letter-spacing: -.02em; font-size: 13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .brand-sub{ font-size: 12px; color: var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top: 2px; }
    .actions{ display:flex; align-items:center; gap:10px; }
    .btn{ border: 1px solid var(--border); background: #fff; color: var(--text); padding: 10px 12px; border-radius: 12px; font-weight: 700; font-size: 13px; cursor: pointer; transition: transform .12s ease; white-space: nowrap; }
    .btn:active{ transform: scale(.98); }
    .btn.primary{ border-color: color-mix(in oklab, var(--accent) 45%, black); background: color-mix(in oklab, var(--accent) 10%, white); }
    .section{ padding: 56px 0; border-bottom: 1px solid rgba(11,19,32,.06); }
    .section:last-child{ border-bottom: 0; }
    .eyebrow{ text-transform: uppercase; letter-spacing: .10em; font-weight: 800; font-size: 12px; color: rgba(11,19,32,.55); }
    h1,h2{ font-family: var(--hFont); letter-spacing: -.03em; margin: 10px 0 0; }
    h1{ font-size: clamp(40px, 5vw, 70px); line-height: .96; }
    h2{ font-size: clamp(28px, 3.2vw, 44px); line-height: 1.05; }
    .lead{ margin-top: 14px; font-size: 16px; line-height: 1.7; color: var(--muted); max-width: 68ch; }
    .cover-grid{ display:grid; grid-template-columns: 1.05fr .95fr; gap: 22px; align-items: stretch; }
    @media (max-width: 900px){ .cover-grid{ grid-template-columns: 1fr; } .section{ padding: 44px 0; } }
    .hero-image{ border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow); overflow:hidden; background: #f3f5f7; min-height: 280px; }
    .hero-image img{ width:100%; height:100%; object-fit:cover; display:block; }
    .meta-row{ margin-top: 18px; display:flex; flex-wrap: wrap; gap: 10px; }
    .meta-pill{ border: 1px solid rgba(11,19,32,.10); background: rgba(11,19,32,.03); padding: 10px 12px; border-radius: 999px; font-size: 13px; font-weight: 600; color: rgba(11,19,32,.78); }
    .meta-pill b{ color: var(--text); }
    .feature{ display:grid; grid-template-columns: 1fr 1fr; gap: 22px; align-items: center; }
    @media (max-width: 900px){ .feature{ grid-template-columns: 1fr; } }
    .feature .image{ border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow); overflow:hidden; background:#f3f5f7; min-height: 260px; }
    .feature .image img{ width:100%; height:100%; object-fit:cover; display:block; }
    .bullets{ margin: 18px 0 0; padding: 0; list-style:none; display:flex; flex-direction:column; gap: 12px; }
    .bullets li{ display:flex; gap: 10px; align-items:flex-start; font-size: 15px; line-height: 1.55; color: rgba(11,19,32,.80); }
    .tick{ width: 22px; height: 22px; border-radius: 8px; background: color-mix(in oklab, var(--accent) 14%, white); border: 1px solid color-mix(in oklab, var(--accent) 30%, white); flex: 0 0 22px; display:flex; align-items:center; justify-content:center; margin-top: 2px; }
    .tick svg{ width: 14px; height: 14px; fill: var(--accent); }
    .package-grid{ margin-top: 22px; display:grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    @media (max-width: 980px){ .package-grid{ grid-template-columns: 1fr; } }
    .pkg{ border-radius: var(--radius); border: 1px solid var(--border); background: #fff; box-shadow: 0 16px 40px rgba(0,0,0,.06); overflow:hidden; position: relative; }
    .pkg.recommended{ border-color: color-mix(in oklab, var(--accent) 45%, white); box-shadow: 0 18px 55px rgba(60,181,76,.14); }
    .pkg-top{ padding: 18px 18px 14px; border-bottom: 1px solid rgba(11,19,32,.08); background: linear-gradient(180deg, rgba(60,181,76,.08), rgba(255,255,255,0)); }
    .pkg-name{ font-family: var(--hFont); font-weight: 800; letter-spacing: -.02em; font-size: 22px; }
    .pkg-tag{ margin-top: 6px; color: var(--muted); line-height: 1.45; font-size: 14px; }
    .pkg-price{ margin-top: 12px; display:flex; align-items:baseline; gap: 10px; flex-wrap: wrap; }
    .pkg-price .amt{ font-family: var(--hFont); font-weight: 800; font-size: 26px; letter-spacing: -.03em; }
    .pkg-price .cad{ font-weight: 800; font-size: 12px; letter-spacing: .08em; text-transform: uppercase; color: rgba(11,19,32,.55); }
    .pkg-body{ padding: 14px 18px 18px; }
    .pkg-note{ margin-top: 16px; color: rgba(11,19,32,.55); font-size: 13px; font-weight: 600; }
    .split{ margin-top: 20px; display:grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 900px){ .split{ grid-template-columns: 1fr; } }
    .panel{ border-radius: var(--radius); border: 1px solid var(--border); background: rgba(11,19,32,.02); padding: 16px; }
    .panel h3{ font-family: var(--hFont); margin: 0 0 12px; font-size: 18px; letter-spacing: -.02em; }
    .steps{ margin-top: 22px; display:grid; grid-template-columns: repeat(3, 1fr); gap: 14px; }
    @media (max-width: 980px){ .steps{ grid-template-columns: 1fr; } }
    .step{ border-radius: var(--radius); border: 1px solid var(--border); background: #fff; padding: 16px; box-shadow: 0 12px 26px rgba(0,0,0,.05); }
    .step .t{ font-family: var(--hFont); font-weight: 800; letter-spacing:-.02em; }
    .step .d{ margin-top: 8px; color: var(--muted); line-height: 1.6; }
    .cards{ margin-top: 22px; display:grid; grid-template-columns: repeat(3, 1fr); gap: 14px; }
    @media (max-width: 980px){ .cards{ grid-template-columns: 1fr; } }
    .card{ border-radius: var(--radius); border: 1px solid var(--border); background: #fff; padding: 16px; box-shadow: 0 12px 26px rgba(0,0,0,.05); }
    .card .n{ font-family: var(--hFont); font-weight:800; letter-spacing:-.02em; }
    .card .d{ margin-top: 8px; color: var(--muted); line-height:1.6; }
    .card .p{ margin-top: 12px; font-weight: 800; }
    .faq{ margin-top: 18px; display:flex; flex-direction:column; gap: 10px; max-width: 820px; }
    details{ border-radius: 14px; border: 1px solid var(--border); background: rgba(11,19,32,.02); padding: 12px 14px; }
    summary{ cursor:pointer; font-weight: 800; list-style:none; display:flex; justify-content:space-between; gap: 10px; }
    summary::-webkit-details-marker{ display:none; }
    .answer{ margin-top: 10px; color: var(--muted); line-height: 1.7; }
    .cta{ border-radius: 22px; border: 1px solid color-mix(in oklab, var(--accent) 25%, white); background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 10%, white), #fff); padding: 22px; box-shadow: 0 18px 60px rgba(60,181,76,.10); }
    .cta-actions{ margin-top: 18px; display:flex; gap: 10px; flex-wrap: wrap; }
    .subnav{ margin-top: 12px; display:flex; flex-wrap: wrap; gap: 8px; }
    .chip{ border: 1px solid rgba(11,19,32,.12); background: rgba(11,19,32,.03); padding: 8px 10px; border-radius: 999px; font-size: 12px; font-weight: 700; color: rgba(11,19,32,.72); }
    .footer{ padding: 28px 0 46px; color: rgba(11,19,32,.55); font-size: 13px; }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="wrap">
      <div class="topbar-inner">
        <div class="brand">
          <div class="logo" id="logoBox" aria-hidden="true"></div>
          <div class="brand-meta">
            <div class="brand-name" id="brandName">Proposal</div>
            <div class="brand-sub" id="brandSub"></div>
          </div>
        </div>
        <div class="actions">
          <button class="btn" id="copyBtn" type="button">Copy link</button>
          <a class="btn primary" id="primaryCta" href="#" target="_blank" rel="noreferrer">Book call</a>
        </div>
      </div>
    </div>
  </header>
  <main id="app"></main>
  <footer class="wrap footer" id="footer"></footer>
  <script>
    const $ = (s) => document.querySelector(s);
    async function loadConfig(){
      try{
        const res = await fetch("./proposal.json", { cache: "no-store" });
        if(!res.ok) throw new Error(`Fetch failed: ${res.status}`);
        return await res.json();
      }catch(err){ return { __error:true, message:String(err) }; }
    }
    function escapeHtml(str){ return String(str ?? "").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"); }
    function escapeAttr(str){ return String(str ?? "").replaceAll('"',"&quot;").replaceAll("'","&#039;"); }
    function money(cfg, n){ const c = cfg?.project?.currency || "CAD"; try{ return new Intl.NumberFormat(undefined, { style:"currency", currency:c, maximumFractionDigits:0 }).format(n); } catch{ return `${c} ${Math.round(n)}`; } }
    function tick(){ return `<span class="tick" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M9.0 16.2 4.8 12 3.4 13.4 9 19 21 7 19.6 5.6z"/></svg></span>`; }
    function sectionShell(id, eyebrow, title, body, inner){ return `<section class="section" id="${escapeAttr(id)}"><div class="wrap">${eyebrow ? `<div class="eyebrow">${escapeHtml(eyebrow)}</div>` : ``}${title ? `<h2>${escapeHtml(title)}</h2>` : ``}${body ? `<div class="lead">${escapeHtml(body)}</div>` : ``}${inner || ``}</div></section>`; }
    function renderCover(cfg, key, sec){ const meta = sec.meta || []; const navEnabled = cfg?.nav?.enabled; return `<section class="section" id="${escapeAttr(key)}"><div class="wrap"><div class="cover-grid"><div><div class="eyebrow">${escapeHtml(sec.kicker || cfg?.project?.date || "")}</div><h1>${escapeHtml(sec.headline || cfg?.project?.title || "Proposal")}</h1><div class="lead">${escapeHtml(sec.subhead || cfg?.project?.subtitle || "")}</div><div class="meta-row">${meta.map(m => `<div class="meta-pill"><b>${escapeHtml(m.label || "")}:</b> ${escapeHtml(m.value || "")}</div>`).join("")}</div>${navEnabled ? `<div class="subnav" id="subnav"></div>` : ``}</div><div class="hero-image">${sec.image?.src ? `<img src="${escapeAttr(sec.image.src)}" alt="${escapeAttr(sec.image.alt || "")}">` : ``}</div></div></div></section>`; }
    function renderFeature(cfg, key, sec){ const image = sec.image?.src ? `<div class="image"><img src="${escapeAttr(sec.image.src)}" alt="${escapeAttr(sec.image.alt || "")}"></div>` : ``; const bullets = (sec.bullets || []).map(b => `<li>${tick()}<span>${escapeHtml(b)}</span></li>`).join(""); const text = `<div>${sec.eyebrow ? `<div class="eyebrow">${escapeHtml(sec.eyebrow)}</div>` : ``}<h2>${escapeHtml(sec.title || "")}</h2>${sec.body ? `<div class="lead">${escapeHtml(sec.body)}</div>` : ``}${bullets ? `<ul class="bullets">${bullets}</ul>` : ``}</div>`; const side = (sec.imageSide || "right").toLowerCase(); const inner = (side === "left") ? `<div class="feature">${image}${text}</div>` : `<div class="feature">${text}${image}</div>`; return `<section class="section" id="${escapeAttr(key)}"><div class="wrap">${inner}</div></section>`; }
    function renderPackages(cfg, key, sec){ const items = sec.items || []; const cards = items.map(p => { const amt = (typeof p.price?.amount === "number") ? money(cfg, p.price.amount) : "—"; const cadence = p.price?.cadence || ""; return `<div class="pkg ${p.recommended ? "recommended" : ""}"><div class="pkg-top"><div class="pkg-name">${escapeHtml(p.name || "")}</div><div class="pkg-tag">${escapeHtml(p.tagline || "")}</div><div class="pkg-price"><div class="amt">${escapeHtml(amt)}</div><div class="cad">${escapeHtml(cadence)}</div></div></div><div class="pkg-body"><ul class="bullets">${(p.bullets || []).map(b => `<li>${tick()}<span>${escapeHtml(b)}</span></li>`).join("")}</ul></div></div>`; }).join(""); return sectionShell(key, sec.eyebrow || "", sec.title || "", "", `<div class="package-grid">${cards}</div>${sec.note ? `<div class="pkg-note">${escapeHtml(sec.note)}</div>` : ``}`); }
    function renderSplit(cfg, key, sec){ return sectionShell(key, sec.eyebrow || "", sec.title || "", "", `<div class="split"><div class="panel"><h3>${escapeHtml(sec.leftTitle || "Included")}</h3><ul class="bullets">${(sec.left || []).map(x => `<li>${tick()}<span>${escapeHtml(x)}</span></li>`).join("")}</ul></div><div class="panel"><h3>${escapeHtml(sec.rightTitle || "Not included")}</h3><ul class="bullets">${(sec.right || []).map(x => `<li><span class="tick" style="background:rgba(11,19,32,.06);border-color:rgba(11,19,32,.12)"></span><span>${escapeHtml(x)}</span></li>`).join("")}</ul></div></div>${sec.footerNote ? `<div class="lead" style="margin-top:16px;">${escapeHtml(sec.footerNote)}</div>` : ``}`); }
    function renderSteps(cfg, key, sec){ const steps = (sec.steps || []).map(s => `<div class="step"><div class="t">${escapeHtml(s.title || "")}</div><div class="d">${escapeHtml(s.desc || "")}</div></div>`).join(""); return sectionShell(key, sec.eyebrow || "", sec.title || "", "", `<div class="steps">${steps}</div>`); }
    function renderCards(cfg, key, sec){ const items = (sec.items || []).map(c => `<div class="card"><div class="n">${escapeHtml(c.name || "")}</div><div class="d">${escapeHtml(c.desc || "")}</div>${typeof c.price === "number" ? `<div class="p">${escapeHtml(money(cfg, c.price))}</div>` : ``}</div>`).join(""); return sectionShell(key, sec.eyebrow || "", sec.title || "", "", `<div class="cards">${items}</div>`); }
    function renderFAQ(cfg, key, sec){ const items = (sec.items || []).map(i => `<details><summary><span>${escapeHtml(i.q || "")}</span><span style="opacity:.55;">+</span></summary><div class="answer">${escapeHtml(i.a || "")}</div></details>`).join(""); return sectionShell(key, sec.eyebrow || "", sec.title || "", "", `<div class="faq">${items}</div>`); }
    function renderCTA(cfg, key, sec){ const primary = sec.primaryCTA || cfg.brand?.primaryCTA || { label:"Book call", href:"#"}; const secondary = sec.secondaryCTA || null; return sectionShell(key, sec.eyebrow || "", sec.title || "", sec.body || "", `<div class="cta"><div class="cta-actions"><a class="btn primary" href="${escapeAttr(primary.href || "#")}" target="_blank" rel="noreferrer">${escapeHtml(primary.label || "Book call")}</a>${secondary ? `<a class="btn" href="${escapeAttr(secondary.href || "#")}" target="_blank" rel="noreferrer">${escapeHtml(secondary.label || "Email")}</a>` : ``}</div><div class="lead" style="margin-top:16px;">${escapeHtml(cfg.brand?.contactLine || "")}</div></div>`); }
    function slugLabel(key, sec){ return sec?.title || sec?.headline || key; }
    function buildSubnav(cfg, keys){ const el = $("#subnav"); if(!el) return; el.innerHTML = keys.filter(k => k !== "cover").map(k => { const sec = cfg.sections?.[k]; const label = slugLabel(k, sec); return `<a class="chip" href="#${escapeAttr(k)}">${escapeHtml(label)}</a>`; }).join(""); }
    function applyTheme(cfg){ const t = cfg.theme || {}; if(t.pageBg) document.documentElement.style.setProperty("--pageBg", t.pageBg); if(t.text) document.documentElement.style.setProperty("--text", t.text); if(t.muted) document.documentElement.style.setProperty("--muted", t.muted); if(t.border) document.documentElement.style.setProperty("--border", t.border); if(typeof t.maxWidth === "number") document.documentElement.style.setProperty("--maxw", t.maxWidth + "px"); const b = cfg.brand || {}; if(b.accent) document.documentElement.style.setProperty("--accent", b.accent); if(b.accentSoft) document.documentElement.style.setProperty("--accentSoft", b.accentSoft); $("#brandName").textContent = b.name || "Proposal"; $("#brandSub").textContent = cfg.project?.title || b.site || ""; const logoBox = $("#logoBox"); if(b.logoUrl){ logoBox.innerHTML = `<img src="${escapeAttr(b.logoUrl)}" alt="${escapeAttr(b.name || "Logo")}">`; } else { logoBox.style.display = "none"; } const p = b.primaryCTA || { label:"Book call", href:"#"}; const a = $("#primaryCta"); a.textContent = p.label || "Book call"; a.href = p.href || "#"; }
    function getEnabledOrder(cfg){ const enabled = cfg.sectionsEnabled || {}; const order = cfg.sectionsOrder || Object.keys(cfg.sections || {}); return order.filter(k => enabled[k] && cfg.sections?.[k]); }
    function renderSection(cfg, key){ const sec = cfg.sections[key] || {}; switch(sec.type){ case "cover": return renderCover(cfg, key, sec); case "feature": return renderFeature(cfg, key, sec); case "packages": return renderPackages(cfg, key, sec); case "split": return renderSplit(cfg, key, sec); case "steps": return renderSteps(cfg, key, sec); case "cards": return renderCards(cfg, key, sec); case "faq": return renderFAQ(cfg, key, sec); case "cta": return renderCTA(cfg, key, sec); default: return sectionShell(key, sec.eyebrow || "", sec.title || key, sec.body || "", ""); } }
    (async () => { const cfg = await loadConfig(); const app = $("#app"); if(cfg.__error){ app.innerHTML = `<div class="wrap" style="padding:24px 18px;"><div style="font-weight:900;">Couldn't load proposal.json</div><div style="margin-top:10px; color:rgba(11,19,32,.7); line-height:1.6;">This usually happens if you opened the file via <b>file://</b>. Use VS Code Live Server.</div><pre style="margin-top:12px; white-space:pre-wrap; opacity:.75;">${escapeHtml(cfg.message)}</pre></div>`; return; } applyTheme(cfg); const keys = getEnabledOrder(cfg); app.innerHTML = keys.map(k => renderSection(cfg, k)).join(""); buildSubnav(cfg, keys); $("#copyBtn").onclick = async () => { try{ await navigator.clipboard.writeText(location.href); $("#copyBtn").textContent = "Copied!"; setTimeout(()=> $("#copyBtn").textContent="Copy link", 1200); }catch{ alert("Couldn't copy automatically. Copy from the address bar."); } }; $("#footer").textContent = `© ${new Date().getFullYear()} ${cfg.brand?.name || "Merchously"} • ${cfg.brand?.contactLine || ""}`; })();
  </script>
</body>
</html>